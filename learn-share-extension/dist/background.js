(()=>{"use strict";chrome.runtime.onMessage.addListener((function(e,s,o){var r;if("GET_TOKEN"===e.type)return chrome.storage.local.get("authToken",(function(e){o({token:e.authToken})})),!0;if("SET_TOKEN"===e.type&&e.token)return chrome.storage.local.set({authToken:e.token},(function(){o({status:"success"})})),!0;if("auth"===e.type){console.log("OAuth Token Received:",e.session);var t=(null===(r=e.session)||void 0===r?void 0:r.startsWith("?"))?e.session:"?".concat(e.session),n=new URLSearchParams(t||""),c=n.get("oauth_token"),i=n.get("oauth_verifier");return c&&i?chrome.storage.local.set({oauthToken:c,oauthVerifier:i},(function(){chrome.runtime.lastError?(console.error("Error storing tokens:",chrome.runtime.lastError.message),o({success:!1,error:chrome.runtime.lastError.message})):(console.log("Tokens stored successfully!"),o({success:!0}))})):(console.error("Tokens not received properly. Missing values in session string:",t),o({success:!1,error:"Missing oauth_token or oauth_verifier.",session:t})),!0}return console.warn("Unknown message type:",e.type),o({success:!1,error:"Unknown message type."}),!0}))})();